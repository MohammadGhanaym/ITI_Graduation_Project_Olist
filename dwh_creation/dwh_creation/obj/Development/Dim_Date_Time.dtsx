<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="10/16/2025 11:08:10 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="DESKTOP-4OLE76B"
  DTS:CreatorName="DESKTOP-4OLE76B\moham"
  DTS:DTSID="{EBDB6A0F-A5D3-4B66-9EE6-F3CACD9DCA3E}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="16.0.5685.2"
  DTS:LocaleID="1033"
  DTS:ObjectName="Dim_Date_Time"
  DTS:PackageType="5"
  DTS:VersionBuild="6"
  DTS:VersionGUID="{A345F132-3953-4E26-875D-B3154F3E56C5}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[localhost\MSSQLSERVER01.olist_dwh]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{2DA7C233-1C01-4FAF-8421-22B0ED39C57B}"
      DTS:ObjectName="localhost\MSSQLSERVER01.olist_dwh">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="1"
          DTS:ConnectRetryInterval="5"
          DTS:ConnectionString="Data Source=localhost\MSSQLSERVER01;Initial Catalog=olist_dwh;Provider=SQLNCLI11.1;Integrated Security=SSPI;Application Name=SSIS-10_dim_date_time-{2DA7C233-1C01-4FAF-8421-22B0ED39C57B}localhost\MSSQLSERVER01.olist_dwh;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\dim_date"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{F5FDF6ED-5D71-48EB-B3C7-9FE8342B0A31}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="dim_date"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{2DA7C233-1C01-4FAF-8421-22B0ED39C57B}"
          SQLTask:SqlStatementSource="&#xA;-- =================================================================&#xA;-- Step 1: Declare variables to hold the dynamic date range&#xA;-- =================================================================&#xA;DECLARE @MinDate DATE;&#xA;DECLARE @MaxDate DATE;&#xA;&#xA;-- =================================================================&#xA;-- Step 2: Find the MIN and MAX dates from your source tables&#xA;-- This query checks both tables to find the earliest and latest possible dates.&#xA;-- =================================================================&#xA;SELECT&#xA;    @MinDate = MIN(DateValue),&#xA;    @MaxDate = MAX(DateValue)&#xA;FROM (&#xA;    -- Get all purchase timestamps from the orders table&#xA;    SELECT order_purchase_timestamp AS DateValue FROM olist_db.dbo.orders&#xA;    UNION ALL&#xA;    -- Get all won dates from the deals table&#xA;    SELECT won_date AS DateValue FROM olist_db.dbo.closed_deals&#xA;) AS AllDates;&#xA;&#xA;-- =================================================================&#xA;-- Step 3: Create the dim_date table structure&#xA;-- =================================================================&#xA;IF OBJECT_ID('dbo.dim_date', 'U') IS NOT NULL&#xA;    DELETE FROM dim_date;&#xA;&#xA;-- =================================================================&#xA;-- Step 4: Use a loop to populate the dim_date table using the variables&#xA;-- =================================================================&#xA;DECLARE @CurrentDate DATE = @MinDate;&#xA;&#xA;WHILE @CurrentDate &lt;= @MaxDate&#xA;BEGIN&#xA;    INSERT INTO [dim_date] (&#xA;        [Date_SK],&#xA;        [FullDate],&#xA;        [DayNumberOfWeek],&#xA;        [DayNameOfWeek],&#xA;        [DayNumberOfMonth],&#xA;        [MonthName],&#xA;        [MonthNumberOfYear],&#xA;        [Quarter],&#xA;        [Year]&#xA;    )&#xA;    VALUES (&#xA;        CONVERT(INT, CONVERT(VARCHAR(8), @CurrentDate, 112)), -- Creates YYYYMMDD key&#xA;        @CurrentDate,&#xA;        DATEPART(weekday, @CurrentDate),&#xA;        DATENAME(weekday, @CurrentDate),&#xA;        DATEPART(day, @CurrentDate),&#xA;        DATENAME(month, @CurrentDate),&#xA;        DATEPART(month, @CurrentDate),&#xA;        DATEPART(quarter, @CurrentDate),&#xA;        DATEPART(year, @CurrentDate)&#xA;    );&#xA;&#xA;    SET @CurrentDate = DATEADD(day, 1, @CurrentDate);&#xA;END;&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\dim_time"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{9840CABA-D401-4BF1-8D78-2EF9B49FBC3E}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="dim_time"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{2DA7C233-1C01-4FAF-8421-22B0ED39C57B}"
          SQLTask:SqlStatementSource="&#xA;IF OBJECT_ID('dbo.dim_time', 'U') IS NOT NULL&#xA;    DELETE FROM dim_time;&#xA;&#xA;&#xA;DECLARE @Hour INT = 0;&#xA;DECLARE @Minute INT = 0;&#xA;DECLARE @Second INT = 0;&#xA;&#xA;WHILE @Hour &lt; 24&#xA;BEGIN&#xA;    SET @Minute = 0;&#xA;    WHILE @Minute &lt; 60&#xA;    BEGIN&#xA;        DECLARE @TimeValue TIME = CAST(RIGHT('0' + CAST(@Hour AS VARCHAR(2)), 2) &#xA;                                    + ':' + RIGHT('0' + CAST(@Minute AS VARCHAR(2)), 2) &#xA;                                    + ':00' AS TIME);&#xA;&#xA;        DECLARE @TimeKey INT = @Hour * 10000 + @Minute * 100;  -- e.g., 134500 for 1:45 PM&#xA;        DECLARE @Hour12 INT = CASE WHEN @Hour = 0 THEN 12 &#xA;                                   WHEN @Hour &gt; 12 THEN @Hour - 12 &#xA;                                   ELSE @Hour END;&#xA;        DECLARE @AMPM CHAR(2) = CASE WHEN @Hour &lt; 12 THEN 'AM' ELSE 'PM' END;&#xA;        DECLARE @HourMinute CHAR(5) = RIGHT('0' + CAST(@Hour AS VARCHAR(2)), 2) &#xA;                                      + ':' + RIGHT('0' + CAST(@Minute AS VARCHAR(2)), 2);&#xA;        DECLARE @Shift VARCHAR(20) = CASE &#xA;                                        WHEN @Hour BETWEEN 6 AND 13 THEN 'Morning'&#xA;                                        WHEN @Hour BETWEEN 14 AND 21 THEN 'Evening'&#xA;                                        ELSE 'Night'&#xA;                                     END;&#xA;&#xA;        INSERT INTO dbo.dim_time (TimeKey, TimeValue, Hour, Minute, Second, Hour12, AMPM, HourMinute, Shift)&#xA;        VALUES (@TimeKey, @TimeValue, @Hour, @Minute, @Second, @Hour12, @AMPM, @HourMinute, @Shift);&#xA;&#xA;        SET @Minute = @Minute + 1;&#xA;    END&#xA;    SET @Hour = @Hour + 1;&#xA;END;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Execute SQL Task"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{D1464A5D-709E-48EC-95B0-B99D29EEC2A3}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Execute SQL Task"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{2DA7C233-1C01-4FAF-8421-22B0ED39C57B}"
          SQLTask:SqlStatementSource="DELETE FROM dim_date&#xA;DELETE FROM dim_time" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{64376C35-97DE-45C8-B8FD-245C96355CEB}"
      DTS:From="Package\Execute SQL Task"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\dim_date" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{3C30B77C-1AD0-4515-A428-7FEF70614E70}"
      DTS:From="Package\Execute SQL Task"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\dim_time" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="133,42"
          Id="Package\dim_date"
          TopLeft="147.5,157.5" />
        <NodeLayout
          Size="126,42"
          Id="Package\dim_time"
          TopLeft="320.5,158.5" />
        <NodeLayout
          Size="176,42"
          Id="Package\Execute SQL Task"
          TopLeft="208.5,50.5" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="268.5,92.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-54.5,65"
              Start="0,0"
              End="-54.5,57.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,22.3513513513514" />
                  <mssgle:CubicBezierSegment
                    Point1="0,22.3513513513514"
                    Point2="0,26.3513513513514"
                    Point3="-4,26.3513513513514" />
                  <mssgle:LineSegment
                    End="-50.5,26.3513513513514" />
                  <mssgle:CubicBezierSegment
                    Point1="-50.5,26.3513513513514"
                    Point2="-54.5,26.3513513513514"
                    Point3="-54.5,30.3513513513514" />
                  <mssgle:LineSegment
                    End="-54.5,57.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="324.5,92.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="59,66"
              Start="0,0"
              End="59,58.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,22.7567567567568" />
                  <mssgle:CubicBezierSegment
                    Point1="0,22.7567567567568"
                    Point2="0,26.7567567567568"
                    Point3="4,26.7567567567568" />
                  <mssgle:LineSegment
                    End="55,26.7567567567568" />
                  <mssgle:CubicBezierSegment
                    Point1="55,26.7567567567568"
                    Point2="59,26.7567567567568"
                    Point3="59,30.7567567567568" />
                  <mssgle:LineSegment
                    End="59,58.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>